<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>リパライン語単語分解</title>
<style>
@font-face {
    font-family: "Cirlipa";
    src: url("./cirlxarli_liparxe_1.woff");  format('woff');
}
textarea{
    font-family: "Cirlipa"; font-size:300%;
}


.nolipa { font-family:"Arial"; }

body{width:70%; margin: 0 auto;}
#main{font-size:110%; margin: 30px;}
</style>
</head>
<body>
	<h1>リパライン語の複合語について考察する</h1>
<p>「<a href="decompose.html">リパライン語単語分解器</a>」の開発ログです。</p>
<h2>1. 準備</h2>
<p>使用する単語リストは、リパライン語OTM-JSONから頭字語などを取り除いた<a href="https://github.com/sozysozbot/akrantiain2/blob/master/samples/input_sample/input_sample_lineparine_renewed.txt">この</a>ファイルから、ピリオドやスペースの入った人名や略号など（la+単語として登録されていたものを含む）などを除いた<a href="words.txt">ファイル</a>。6557項目が登録されている。</p>
<p>さて、実はリパライン語には「<a href="https://fafss.slack.com/archives/C7DC7976K/p1506990956000054">単語と単語がくっ付くときは-r-でしかないのと、-r-はそこまで頻繁に使われないから大半の単語の語幹は一意に決められる</a>」という特性がある。登録されている項目をハイフンの位置により「独立単語」「前置辞」「語中辞」「語尾辞」に分類すれば、独立語と独立語の間には-r-が入るということである。</p>
<p>要するに、「どちらかの側にはハイフンが入っている」という原則と考えれば良い。例を挙げれば、<code>dytyleter</code>は<code>dyty-</code>, <code>-l-</code>, <code>et</code>, <code>-er</code>と分解されるが、このとき項目と項目の間には1つ以上のハイフンが入っている。</p>
<blockquote class="twitter-tweet" data-lang="ja"><p lang="ja" dir="ltr">とりあえず素朴な実装をして、「いや、この分解はありえない」とかを指摘してもらった方がいいか</p>&mdash; .sozysozbot.@hsjoihs (@sosoBOTpi) <a href="https://twitter.com/sosoBOTpi/status/923338213392969729?ref_src=twsrc%5Etfw">2017年10月25日</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>とりあえず、文法的な考察をする前に、この条件だけで全探索するプログラムを書いてみるか。やってくうちに追加条件が出てくるでしょう</p>
<h2>2. 軽く実装</h2>
<p>とりあえず、ハイフンの有無で4ファイルに分離。</p>
<p>規則も記述してJSONにする。</p>
<p>実装できた。</p>
<img src="demo.png" width="500"/>

<h2>3. 改良</h2>
<p>いくつか情報が来たので、それを元に改良する。</p>
<p>まず「語中辞は後方に形態素を要求するが、独立単語(語根)を直接繋げられるのは-r-と-rapt-のみである。-inie-は数詞のみ、その他緩衝音類は後方には接辞を要求する。」とのこと。これに基づいて規則を改定する。</p>
<p>現状の規則はこんな感じ。</p>
<pre>
[
	["INITIAL","q"],
	["INITIAL","q-"],

	["q","-q"],
	["q","-q-"],

	["q-","q"],
	["q-","q-"],
	["q-","-q"],
	["q-","-q-"],

	["-q","-q"],
	["-q","-q-"],

	["-q-","q"],
	["-q-","q-"],
	["-q-","-q"],
	["-q-","-q-"],

	["q","FINAL"],
	["-q","FINAL"]
]
</pre>
<p>語中辞を"-q-"と"-r-"に分離して…っと、待てよ。「緩衝音類は後方には接辞を要求する。」にしてしまうとdytyleterが通らないな。「前に来てるのが接辞なら後ろは単語でもいい」のかと聞いてみたところ、『「緩衝音類は前後のいずれかに接辞を要求する」かなあ』とのこと。</p>
<p>さて、これをどう落とし込むかだが、まあ「同一の-q-を2種類立てる」が一時しのぎとしては有効かな。</p>
<p>これをやると重複が発生するので、重複を消去。</p>
<p>いや、うまくやれば解決できるか。「qに後続した場合だけ-q1-、それ以外は-q2-のみ」でいい。</p>
<p>よし重複解決。</p>
<p>しかし["la","-axm","-el","-e-","n"]は弾かれない。これを弾くなら、「緩衝音類は、前に接頭辞が来るか後ろに接尾辞が来るかの2択だ」と定式化すべきだな。</p><p>「la-stan-a-'sみたいなことはあるので前後同時に接辞が来ることもある（まあ、弾くわけではないからこれも含むか）」と言われた。まあそうよね。</p>
<p>とりあえず実装できた。</p>

<h2>4. さらに改良</h2>
<p>ff「特別警察」が辞書に紛れ込んでいたので削除。</p>
<p>-tは格語尾（「基本的に-'s, -'i, -'cにしかつかないが、-'lt, -'scitの形とかもあるかもしれない」とのこと）とか分離標識とか複代副詞とかにしかつかないらしい。そして必ず語末である。</p>
<p>とりあえず、「必ず語末」「接頭辞・語中辞の後には来ない」が言えるので実装する。</p>
<p>実装した。</p>
<p>「緩衝音が連続することは無い」と言われた。実装した。["dyty-","-l-","et","-er"], ["pask-","-effe","-snej"], ["la","-axm","-el","-en"]が完璧に分解され、「緩衝音が連続しないことは重要だったんやな……」「雰囲気で読んでるからほんとこういう実装をする時に本質が見えてくるのすこ」となった。よきかな。</p>
<p>このことを自慢できるように、複数の単語を入力できるようにした。</p>
<p>句読点を自動で消して、勝手に小文字にするようにもした。</p>

<h2>5. 古いもの</h2>
<p>-b- -f- -g- -j- -kh- -rj- -rv- -rw- -rz- -s- -ska -ski -w- -xiciは廃止されたので、「基本無効化して、オプションで有効化させるなどしたい」「廃止された緩衝子音はほとんど出てこないのでそっちの方がいい」となった。</p>
<p>実装した。</p>

<h2>6. 音階</h2>
<p>「<a href="http://jurliyuuri.com/niesnurjorup/">音楽について考察する</a>」でte ke xa sa nje vi fyが非真理設定になった。これにより、xace ["xa","-ce"] 「純粋なミ」とかが潰せる。よってこいつらを辞書から削除。

<h2>7. 単語登録</h2>
いせにほにdzeparkymerfestiが出てくるので、こちらの辞書では未登録なkymerfを登録。
<pre>
kymerf

【名詞】裁判官
【名詞】(アレス裁判における)キルメプ

[2017:kil mep:FAS:裁断者]
</pre>

<h2>8. 単語削除</h2>
<p>せっかく登録したkymerfが<a href="http://lineparine.blogspot.com/2017/11/fas.html">廃止</a>された。ついでにattadzem, nabi'a, splieng, tatiryzurtmilも廃止された。よって以上5単語を辞書から削除。</p>

<h2>9. 現状の規則を表にする</h2>
<p>現状の規則を把握するのがそろそろ大変になってきたので、表を作る。</p>
<p><a href="https://docs.google.com/spreadsheets/d/1Ot7cHJbo3dX2lBpdfqju7L5PjDshuN_aZQH8F3iFCzs/edit#gid=0">作った</a>。</p>
<img src="table.png" width="800"/>

<h2>10. eu-と-eu</h2>
<p>DMで「詩語だったらeu--euがどこにでも出て来るので、mi'steuみたいな使い方も許容される」「緩衝音の前後にeuを置くのはセーフ」「普通の接辞と同じで挟まれて語中に出て来ることもある」「二つの独立語を-eu-で結ぶのはアウト」ということを教わった。</p>
<p>ということで、接頭辞eu-と接尾辞-euの挙動はほかのやつらとは異なりますな。-r-群・-q1-群・-q2-群にも当てはまらないので、接中辞として立てる必要もない。</p>

<pre>
j.v「-tの前に緩衝音は禁止だが、緩衝音ではない-euについてもmi'seutはアウトよな？」
fafs f. sashimi「見たことないし、そんな書き方したくないけどアウトとまでは厳しくないなあ。まあアウトで良いかと思うけど」
j.v「じゃあアウトで（どっちに設定しても手間は変わらんが、まあアウトでいいでしょ）」
fafs f. sashimi「多分実例がない。格助詞と-tは間が無菌状態が好まれるので(意味不明)」
</pre>
<p>また、「単語+緩衝音+eu」で語が終わるのはセーフで、artergeu[arte-rg-eu]とか可能だそうだ。</p>
<p>「接頭辞+eu」で1語判定、はアウトだが、eu(m)oは単語になりうる(だが意味がない)ので「eu- + 接尾辞」はセーフ。</p>
<p>「単語-r-eu」はアウトだが、「単語-r-eu-単語」はセーフ。ただ、これは「単語」と「eu-単語」を-r-で繋いだもの。</p>
<p>-eu-euは「許可だよ、やらないけど」とのこと。「普通緩衝子音が挟まれ, -eumeuになるけどやるときはやるからなあ」と。</p>

<p>eu-についても同様の考察を行なったが、結果として「普通の接頭辞と完全に同じ挙動である」ということがわかった。</p>

<p>また、*dytyrlarta案件:「q-の後に-r-は来られないのに許容している」というバグを見つけた。あと、「品詞語尾以外の殆どの接辞同士の結合のみで語を構成することはおそらく認められない」という情報が入った（つまり*dytydirはダメ）ので、次回のアプデで修正をかける。</p>

<p>結果、表は次のようになる。</p>
<img src="table2.png" width="800"/>

<h2>11. リパーシェ表示機能</h2>
<p>「表示をリパーシェに変更したり、しなかったりできるチェックボックス」が欲しいと言われたので作った。</p>

<h2>12. 数</h2>
<p>100tvamとか3'dとかに対応した。</p>
<p>「fente2とかdyty100'dみたいな表現って（意味が通らないのはともかくとして）文法上合法？」と訊いたところ、「合法」とのこと。ちなみにFixa.siertija氏が「fente2、何かに使えそう。コンピュータに関係する反対運動の総称とか(ゲームしてたりスマホ使ってたら頭が悪くなるみたいな類い)」などと興味深い発想をしていた。（以上のやり取りもTWTで行われた。）</p>
</body>
</html>
